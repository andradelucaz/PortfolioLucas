---
title: "O mercado de trabalho para cientistas de dados - Análise Exploratória"
description: |
  Essa é uma análise exploratória a respeito de algumas características do mercado de Ciência de Dado. [EM CONSTRUÇÃO]
author:
  - name: Lucas Andrade
    url: https://www.linkedin.com/in/lucas-silva-andrade-155a27165/
date: 2021-12-09
output:
  distill::distill_article:
    self_contained: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

Esse é o meu primeiro projeto no portfólio.

Uma olhada rápida nas vagas de emprego divulgadas no LinkedIn e encontraremos um enorme volume de oportunidades na área Tech, dentre elas para as posições de Cientista de Dados. Com um mercado apontado para a alta demanda por profissionais da ciência de dados, será possível identificar o atual cenário de remuneração desses profissionais? Quem são esses profissionais? Como se comporta a remuneração de um cientista de dados em função de suas características? Onde estão os maiores salários? Para tentar responder a todos esses questionamentos, faremos aqui uma análise exploratória da base de dados da RAIS anonimizada.

A RAIS ou Relação Anual de informações Sociais, é um relatório de informações socioeconômicas solicitado pela Secretaria de trabalho do Ministério da Economia brasileiro Pàs pessoas jurídicas e outros empregadores anualmente.

#Acessando os dados da RAIS

Para essa análise vamos utilizar o datalake da incrível iniciativa **Base dos Dados** (<https://basedosdados.org/>), utilizaremos ainda os pacotes bigrquery e tidyverse

#carregando os pacotes

```{r echo=TRUE, message=FALSE, warning=FALSE}
library(bigrquery)
library(tidyverse)
```

#realizando a conexão com o Data Lake

```{r echo=TRUE}
conexao <- dbConnect(
  bigquery(),
  project = 'basedosdados',
  dataset = 'br_me_rais',
  billing = 'analise-rais-portfolio'
)
```

#conhecendo a base e carregando as 5 primeiras linhas da tabela

```{r echo=TRUE, message=FALSE, warning=FALSE}

tbl(conexao, "microdados_vinculos") %>%
  select (everything()) %>%
  head(5) %>%
  collect()

```

Para analisar apenas os dados relacionados à ciência de dados entre 18 e 80 anos, precisaremos filtrar a base. Utilizaremos como filtro os códigos dos vínculos declarados que se relacionam à ciência de dados e são cadastrados no Código Brasileiro de Ocupação. A base RAIS será então filtrada tomando como critérios os ódigos das profissões atreladas à ciência de dados.

```{r eval=FALSE, include= TRUE}
codigos_cbo <- c ('252515', "252525", "211110", 
                  #pesquisa científica
                  '203105',
                  #pesquisador em ciêcnia da computação e informática
                  '211205', '211210', '411035',
                  '131120', '211215' 
                  #ocupações estatísticas
)

```

#carregando a base filtrada pelos CBOs de Cientistas de Dados com idade entre 18 e 80 anos

```{r eval=FALSE, include=FALSE}

tabela_micrdodados_vinculos_tbl <- tbl(conexao, "microdados_vinculos") %>% 
  select (everything()) %>% 
  filter(
    ano >= 2013,
    cbo_2002 %in% codigos_cbo,
    filter %in% c(18:80)
    )

tabela_microdados_vinculos <- collect(tabela_micrdodados_vinculos_tbl)

saveRDS(tabela_microdados_vinculos, "tabela_microdados_vinculos.rds" )
```

Os dados já carregados servirão para responder à pergunta principal que move essa análise: **"Quanto ganha em média, uma pessoa que trabalha com ciência de dados?**

Segundo os dados registrados na base RAIS, uma pessoa que trabalha com ciência de dados recebe em média:

```{r echo=TRUE}

tabela_microdados_vinculos <- readRDS("tabela_microdados_vinculos.rds")

round(mean(tabela_microdados_vinculos$valor_remuneracao_media),2)

```

Além dessa pergunta principal, podemos ainda nos aprofundarmos na análise e responder ao seguintes questionamentos:

-   **Como se comportou o salário médio de uma pessoa cientista de dados ao longo dos últimos anos?**

    ```{r fig.align='center'}
    media_ano <- tabela_microdados_vinculos %>% 
      group_by(ano) %>% 
      summarise(media_salarial = round(mean(valor_remuneracao_media),2))

    knitr::kable(media_ano)
    ```

    ```{r}
    ggplot(media_ano) +
    geom_col(aes(x = ano, y = media_salarial, fill = ano), show.legend = FALSE) +
    geom_text(aes(x = ano, y = media_salarial*0.85, label = media_salarial, fontface = 'bold'))+
    labs(x = "\nAno\n", y = "\nSalário médio (R$)\n", title = "Salário médio de um cientista de dados por ano")+
    theme_minimal()+
    scale_x_continuous(breaks = c(2013:2019))
    ```

-   **Qual estado do Brasil tem o maior salário médio?**

```{r include=FALSE, fig.align='center'}

media_uf <- tabela_microdados_vinculos %>% 
  group_by(sigla_uf) %>% 
  summarise(media = round(mean(valor_remuneracao_media), 2)) %>% 
  arrange(desc(media))

```

```{r}
knitr::kable(head(media_uf))

```

```{r fig.width = 10, fig.height = 10, fig.align='center'}

media_uf %>% 
  mutate(sigla_uf = fct_reorder(sigla_uf, media)) %>% 
  arrange(desc(sigla_uf)) %>% 
  ggplot() +
  geom_col(aes(x = media, y = sigla_uf, fill = sigla_uf), show.legend = FALSE) +
  geom_text(aes(x = (media*0.8), y = sigla_uf, label = media)) +
  theme_minimal()+
  labs(x = "\nSalário médio (R$)\n", y = "\nUnidade da Federação\n", title = "Salário médio de um cientista de dados por estado")
```

-   **Como se comporta o salário médio de uma pessoa cientista de dados em função das seguintes características:**

    -   Gênero

```{r}

media_genero <- tabela_microdados_vinculos %>%
  mutate(sexo = ifelse(sexo == 1, "Masculino", "Feminino")) %>% 
  group_by(sexo) %>% 
  summarise(media = round(mean(valor_remuneracao_media),2))


```

```{r fig.width=6, fig.height=5, fig.align='center'}

media_genero %>%
  ggplot()+
  geom_col(aes(x = sexo, y = media, fill = sexo), show.legend = FALSE) +
  geom_text(aes(x = sexo, y = media*0.85, fontface = 'bold', label = media)) +
  theme_minimal()+
  labs(x = "\nGênero", y = "\nSalário Médio(R$)\n", title = "Salário médio de um cientista de dados por gênero")
  

```

-   <div>

    Raça/cor

    </div>

```{r}
media_raca <- tabela_microdados_vinculos %>% 
   mutate(raca_cor= case_when(
                              raca_cor == 1 ~ "Indígena",
                              raca_cor == 2 ~ "Branca",
                              raca_cor == 4 ~ "Preta",
                              raca_cor == 6 ~ "Amarela",
                              raca_cor == 8 ~ "Parda",
                              raca_cor == 9 ~ "Não identificado",
                              raca_cor == -1 ~ "Ignorado"
                              )) %>% 
  mutate(sexo = ifelse(sexo == 1, "Masculino", "Feminino")) %>% 
  group_by(raca_cor) %>% 
  summarise(media = round(mean(valor_remuneracao_media), 2))

knitr::kable(media_raca)
```

```{r fig.width=7, fig.height=4, fig.align='center'}
media_raca %>% 
  mutate(raca_cor = fct_reorder(raca_cor, media)) %>% 
  arrange(raca_cor, desc = FALSE) %>% 
  ggplot()+
  geom_col(aes( y = raca_cor, x = media, fill = raca_cor), show.legend = FALSE)+
  geom_text(aes(x = media*0.8, y = raca_cor, label = media))+
  theme_minimal()+
  labs(y = "\nRaça/Cor", x = "\nSalário médio (R$)", title = "Salário médio de um cientista de dados por Raça/Cor")

```

-   <div>

    Idade

    </div>

```{r}
media_idade <- tabela_microdados_vinculos %>% 
  mutate(faixa_etaria = case_when(
                            faixa_etaria == 1 ~ "10 a 14",
                            faixa_etaria == 2 ~ "15 a 17",
                            faixa_etaria == 3 ~ "18 a 24",
                            faixa_etaria == 4 ~ "25 a 29",
                            faixa_etaria == 5 ~ "30 a 39",
                            faixa_etaria == 6 ~ "40 a 49",
                            faixa_etaria == 7 ~ "50 a 64",
                            faixa_etaria == 8 ~ "65 ou mais",
                          )) %>%
  group_by(faixa_etaria) %>% 
  summarise(media = round(mean(valor_remuneracao_media), 2), mediana = round(median(valor_remuneracao_media),2))

knitr::kable(media_idade)

```

```{r fig.width=11, fig.height=8, fig.align='center'}

media_idade %>% 
  ggplot(aes(x=faixa_etaria, y = media)) +
  geom_col(aes(fill = faixa_etaria)) +
  geom_text(aes(x = faixa_etaria, y = media*0.85, label = media ))+
  labs( x = "\nIdade (anos)\n", y = "\nSalário médio R$\n", title =  "Salário médio de um cientista de dados por faixa etária")


```
